{{ define "base/index.html.tmpl" }}
<!doctype html>
<html>
  <head>
    <title> {{.title}} </title>
    <link rel="stylesheet" href="/static/style.css" />
    <link rel="stylesheet" href="/static/override.css" />
    <link rel="icon" href="/static/favicon.png" />
    <meta charset="utf-8" />
    <!-- <script type="text/javascript" src="/static/wasm_exec.min.js"> -->
      <script  type="text/javascript" src="/static/bitchan_post.js" />
    </script>
  </head>
  <body>
    <!--
    <noscript>
      yes this requires js. no it won't work without it. yes i hate it too, the web was a mistake.
    </noscript>
    <script>
      const go = new Go();
      WebAssembly.instantiateStreaming(fetch("/static/bitchan.wasm"), go.importObject).then((result) => {
        go.run(result.instance);
      });
    </script>
    -->
    <form method="post" action="/bitchan/v1/post" enctype="multipart/form-data">
      <input type="file" name="file" />
      <textarea name="comment"></textarea>
      <input type="submit" value="post" />
    </form>
    <div id="posts">
    </div>
    <script>
      let root = document.getElementById("posts");
      fetch('/bitchan/v1/posts.json')
  .then(response => response.json())
  .then(data => {
    if(data['posts']) 
    {
    for(post of data['posts'])
    {
      let e = document.createElement("div");
      let a = document.createElement("a");
      a.href = "/bitchan/v1/post?infohash_hex="+post;
      a.innerText = post;
      e.appendChild(a);
      root.appendChild(e);
    }
    }
  })
  .catch(error => console.error(error))
    </script>
  </body>
</html>
{{ end }}
